docker pull debian:buster

docker run -tid --privileged -v /dev/bus/usb:/dev/bus/usb -v /dev:/dev -v /tmp/.X11-unix:/tmp/.X11-unix:ro -v $XAUTHORITY:/home/user/.Xauthority:ro --net=host --env="DISPLAY=$DISPLAY" --env="LC_ALL=C.UTF-8" --env="LANG=C.UTF-8" --name karlibts_usrp debian:buster

xhost +

docker exec -ti karlibts_usrp /bin/bash

cat > /etc/apt/sources.list <<EOF
> deb http://archive.debian.org/debian buster main contrib non-free
> deb http://archive.debian.org/debian-security buster/updates main
> # deb-src http://deb.debian.org/debian/ buster main contrib
> EOF

echo 'Acquire::Check-Valid-Until "0";' > /etc/apt/apt.conf.d/99no-check-valid-until

apt update

# installing depencies


apt install nano wget


apt install libtool shtool automake dahdi-source libssl-dev sqlite3 libsqlite3-dev libsctp-dev libfftw3-dev libfftw3-3 autoconf libsctp-dev libgnutls28-dev libcurl4-gnutls-dev git-core pkg-config make gcc gcc-arm-none-eabi doxygen libtalloc-dev libpcsclite-dev libusb-1.0-0-dev

apt install autoconf automake build-essential ccache cmake cpufrequtils doxygen ethtool g++ git inetutils-tools libboost-all-dev libncurses5 libncurses5-dev libusb-1.0-0 libusb-1.0-0-dev libusb-dev python3-dev python3-mako python3-numpy python3-requests python3-scipy python3-setuptools python3-ruamel.yaml 


apt install libuhd-dev uhd-host



uhd_images_downloader


uhd_usrp_probe

apt install libortp-dev
apt install libtool shtool automake dahdi-source libssl-dev sqlite3 libsqlite3-dev libsctp-dev libfftw3-dev libfftw3-3 autoconf libsctp-dev libgnutls28-dev libcurl4-gnutls-dev git-core pkg-config make doxygen libtalloc-dev libpcsclite-dev libusb-1.0-0-dev

installing libosomcore

git clone https://git.osmocom.org/libosmocore.git

cd libosmocore/

git checkout cf70aa0c40c574c32b832454f725cc37459c5d8d

autoreconf -i

./configure

make -j4

make install

ldconfig -i

cd ../..

installing dependencies before libosmo-abis

installing libosmo-abis

git clone https://git.osmocom.org/libosmo-abis.git

cd libosmo-abis/

git checkout 39dffb6c29a8d78ba8527aa4ccc13f34d1c3b319

autoreconf -i

./configure

make -j4

make install

ldconfig

cd ..

installing libosmo-netif

git clone https://git.osmocom.org/libosmo-netif.git

cd libosmo-netif/

git checkout 09c71b04f5a8d82515d0d4d541b8368b585dbd31

autoreconf -i

./configure

make -j4

make install

ldconfig

cd ..

installing dependecies for openbsc

apt install build-essential gcc g++ make automake autoconf libtool pkg-config libtalloc-dev libpcsclite-dev libortp-dev libsctp-dev libssl-dev libdbi-dev libdbd-sqlite3 libsqlite3-dev libpcap-dev libc-ares-dev libgnutls28-dev libsctp-dev sqlite3 libsofia-sip-ua-glib-dev libusb-1.0-0-dev libfftw3-dev libgsm1-dev

apt install autoconf automake build-essential ccache cmake cpufrequtils doxygen ethtool g++ git inetutils-tools libboost-all-dev libncurses5 libncurses5-dev libusb-1.0-0 libusb-1.0-0-dev libusb-dev python3-dev python3-mako python3-numpy python3-requests python3-scipy python3-setuptools python3-ruamel.yaml

apt install asterisk telnet python3-pip

installing open-bsc

git clone https://git.osmocom.org/openbsc.git

cd openbsc/openbsc/

git checkout d2550da76f9974bb1957f74c5d3eb75fdae923d9

autoreconf -i

./configure

make -j4

make install

ldconfig

cd ../..


installing osmo-bts

git clone https://git.osmocom.org/osmo-bts.git

cd osmo-bts/

git checkout 59e7773055335a12d749faf84d88a8ed9fa0f201

autoreconf -i

./configure --enable-trx

make -j4

make install

ldconfig

cd ../..

osmo-trx replace osmoco: 
git clone https://gitea.osmocom.org/cellular-infrastructure/osmo-trx.git

git clone https://gitea.osmocom.org/cellular-infrastructure/osmo-trx.git

cd osmo-trx
# 6e369348b026006bb483b7d3eb57ce5828e5f6bc

git checkout 6e369348b026006bb483b7d3eb57ce5828e5f6bc

autoreconf -i
./configure --with-uhd
make -j4
make install 
ldconfig


Configure osmo-trx-uhd.cfg
log stderr
 logging filter all 1
 logging color 1
 logging print category 1
 logging timestamp 1
 logging print file basename
 logging level set-all notice
!
line vty
 no login
!
trx
 bind-ip 127.0.0.1
 remote-ip 127.0.0.1
 egprs disable
 tx-sps 4
 rx-sps 4
 clock-ref external
 chan 0


log stderr
 logging filter all 1
 logging color 1
 logging print category 1
 logging timestamp 1
 logging print file basename
 logging level set-all notice
!
line vty
 no login
!
trx
 bind-ip 127.0.0.1
 remote-ip 127.0.0.1
 egprs disable
 tx-sps 4
 rx-sps 4
 clock-ref external
 chan 0


Before launching preparing all configs

config file of osmo-bts

wget https://raw.githubusercontent.com/SitrakaResearchAndPOC/CalypsoBTS_Debian/main/osmo-bts.cfg

config file of open-bsc

wget https://raw.githubusercontent.com/SitrakaResearchAndPOC/CalypsoBTS_Debian/main/open-bsc.cfg

config hlr.sqlite3

touch hlr.sqlite3

apt install netcat wireshark

exit


Terminal 2

docker exec -ti karlibts_usrp osmo-trx-uhd -C osmo-trx-uhd.cfg


Tape ctrl+shift+T
Terminal 3

docker exec -ti karlibts_usrp osmo-nitb -c open-bsc.cfg -l hlr.sqlite3 -P -C --debug=DRLL:DCC:DMM:DRR:DRSL:DNM

Tape ctrl+shift+T
Terminal 4

docker exec -ti karlibts_usrp osmo-bts-trx -c osmo-bts.cfg --debug DRSL:DOML:DLAPDM -i 127.0.0.1

